{% if not incident %}
<div class="p-4 text-sm text-slate-400">Incident not found.</div>
{% else %}
<div class="p-4" data-incident-id="{{ incident.incident_id }}">
  <div class="flex items-start justify-between gap-2">
    <div class="min-w-0">
      <div class="text-sm font-semibold">{{ incident.title }}</div>
      <div class="mt-1 text-xs text-slate-400">{{ incident.category }} • sev {{ incident.severity_score }}</div>
    </div>
    <button
      class="rounded bg-slate-800 px-2 py-1 text-xs hover:bg-slate-700"
      hx-get="/partials/incident/{{ incident.incident_id }}"
      hx-target="#incident-detail-content"
      hx-swap="innerHTML"
    >
      Refresh
    </button>
  </div>

  <div class="mt-3 rounded border border-slate-800 bg-slate-900/60 p-3">
    <div class="text-xs font-semibold text-slate-200">What happened</div>
    <div class="mt-1 text-sm text-slate-300">{{ incident.summary }}</div>
  </div>

  <div class="mt-3 rounded border border-slate-800 bg-slate-900/60 p-3">
    <div class="text-xs font-semibold text-slate-200">Location</div>
    <div class="mt-1 text-sm text-slate-300">
      {{ incident.location_confidence }} — {{ incident.location_rationale }}
    </div>
    {% if incident.lat and incident.lon %}
    <div class="mt-1 text-xs text-slate-500">lat {{ incident.lat }} • lon {{ incident.lon }}</div>
    {% endif %}
  </div>

  <div class="mt-3">
    <div class="text-xs font-semibold text-slate-200">Updates</div>
    <div class="mt-2 space-y-2">
      {% for item in items %}
      <div class="rounded border border-slate-800 bg-slate-900/40 p-3">
        <div class="flex items-start justify-between gap-2">
          <div class="min-w-0">
            <div class="truncate text-sm font-semibold">{{ item.title }}</div>
            <div class="mt-0.5 truncate text-xs text-slate-400">{{ item.source_id }} • {{ item.published_at | eu_datetime }}</div>
          </div>
          <a class="shrink-0 text-xs text-blue-400 hover:text-blue-300" href="{{ item.url }}" target="_blank">Open</a>
        </div>
        {% if item.summary %}
        <div class="mt-1 text-sm text-slate-300">{{ item.summary }}</div>
        {% endif %}
      </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endif %}
